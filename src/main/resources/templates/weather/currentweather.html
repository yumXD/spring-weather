<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>오늘의 날씨</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="mb-4">오늘의 현재 날씨</h1>

      <!-- 날씨 정보 카드를 그리드 시스템으로 나열 -->
      <div class="row">
        <!-- 각 도시별로 카드 생성 -->
        <div class="col-md-4 mb-4" id="city-card-1">
          <!-- 날씨 정보가 표시될 곳 -->
        </div>
        <div class="col-md-4 mb-4" id="city-card-2">
          <!-- 날씨 정보가 표시될 곳 -->
        </div>
        <div class="col-md-4 mb-4" id="city-card-3">
          <!-- 날씨 정보가 표시될 곳 -->
        </div>
        <div class="col-md-4 mb-4" id="city-card-4">
          <!-- 날씨 정보가 표시될 곳 -->
        </div>
      </div>
    </div>

    <!-- Bootstrap JS 및 Popper.js 추가 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>

    <script>
      const cities = ["Seoul", "Busan", "New York", "Tokyo"]; // 원하는 도시명으로 변경

      cities.forEach((city, index) => {
        fetch(`/api/weather/current?city=${city}`)
          .then((response) => response.json())
          .then((data) => {
            // 캘빈에서 섭씨로 변환하는 함수
            function kelvinToCelsius(kelvin) {
              return kelvin - 273.15;
            }

            // 데이터 처리 및 화면에 표시
            const cityCard = document.getElementById(`city-card-${index + 1}`);
            cityCard.innerHTML = `
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">${data.name}, ${
              data.sys.country
            }</h5>
                                <p class="card-text">온도: ${kelvinToCelsius(
                                  data.main.temp
                                ).toFixed(0)}°C</p>
                                <p class="card-text">체감 온도: ${kelvinToCelsius(
                                  data.main.feels_like
                                ).toFixed(0)}°C</p>
                                <p class="card-text">날씨: ${
                                  data.weather[0].description
                                }</p>
                                <p class="card-text">풍속: ${
                                  data.wind.speed
                                } m/s</p>
                                <p class="card-text">구름: ${
                                  data.clouds.all
                                }%</p>
                            </div>
                        </div>
                    `;
          })
          .catch((error) => {
            console.error(`API 호출 오류: ${error.message}`);
          });
      });
    </script>
  </body>
</html>
